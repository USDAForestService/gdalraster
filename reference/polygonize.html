<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a polygon feature layer from raster data — polygonize • gdalraster</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a polygon feature layer from raster data — polygonize"><meta name="description" content="polygonize() creates vector polygons for all connected regions of pixels
in a source raster sharing a common pixel value. Each polygon is created
with an attribute indicating the pixel value of that polygon. A raster mask
may also be provided to determine which pixels are eligible for processing.
The function will create the output vector layer if it does not already
exist, otherwise it will try to append to an existing one.
This function is a wrapper of GDALPolygonize in the GDAL Algorithms API.
It provides essentially the same functionality as the gdal_polygonize.py
command-line program (https://gdal.org/en/stable/programs/gdal_polygonize.html)."><meta property="og:description" content="polygonize() creates vector polygons for all connected regions of pixels
in a source raster sharing a common pixel value. Each polygon is created
with an attribute indicating the pixel value of that polygon. A raster mask
may also be provided to determine which pixels are eligible for processing.
The function will create the output vector layer if it does not already
exist, otherwise it will try to append to an existing one.
This function is a wrapper of GDALPolygonize in the GDAL Algorithms API.
It provides essentially the same functionality as the gdal_polygonize.py
command-line program (https://gdal.org/en/stable/programs/gdal_polygonize.html)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gdalraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.12.0.9156</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/gdal-block-cache.html">GDAL Block Cache</a></li>
    <li><a class="dropdown-item" href="../articles/gdal-config-quick-ref.html">GDAL Config Quick Reference</a></li>
    <li><a class="dropdown-item" href="../articles/gdalvector-draft.html">Draft Bindings to the GDAL/OGR Vector API</a></li>
    <li><a class="dropdown-item" href="../articles/raster-api-tutorial.html">Raster API Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/raster-attribute-tables.html">Raster Attribute Tables</a></li>
    <li><a class="dropdown-item" href="../articles/raster-display.html">Raster Display</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/USDAForestService/gdalraster/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a polygon feature layer from raster data</h1>
      <small class="dont-index">Source: <a href="https://github.com/USDAForestService/gdalraster/blob/main/R/gdalraster_proc.R" class="external-link"><code>R/gdalraster_proc.R</code></a></small>
      <div class="d-none name"><code>polygonize.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>polygonize()</code> creates vector polygons for all connected regions of pixels
in a source raster sharing a common pixel value. Each polygon is created
with an attribute indicating the pixel value of that polygon. A raster mask
may also be provided to determine which pixels are eligible for processing.
The function will create the output vector layer if it does not already
exist, otherwise it will try to append to an existing one.
This function is a wrapper of <code>GDALPolygonize</code> in the GDAL Algorithms API.
It provides essentially the same functionality as the <code>gdal_polygonize.py</code>
command-line program (<a href="https://gdal.org/en/stable/programs/gdal_polygonize.html" class="external-link">https://gdal.org/en/stable/programs/gdal_polygonize.html</a>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">polygonize</span><span class="op">(</span></span>
<span>  <span class="va">raster_file</span>,</span>
<span>  <span class="va">out_dsn</span>,</span>
<span>  <span class="va">out_layer</span>,</span>
<span>  fld_name <span class="op">=</span> <span class="st">"DN"</span>,</span>
<span>  out_fmt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  connectedness <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  src_band <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mask_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nomask <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dsco <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lco <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-raster-file">raster_file<a class="anchor" aria-label="anchor" href="#arg-raster-file"></a></dt>
<dd><p>Filename of the source raster.</p></dd>


<dt id="arg-out-dsn">out_dsn<a class="anchor" aria-label="anchor" href="#arg-out-dsn"></a></dt>
<dd><p>The destination vector filename to which the polygons will be
written (or database connection string).</p></dd>


<dt id="arg-out-layer">out_layer<a class="anchor" aria-label="anchor" href="#arg-out-layer"></a></dt>
<dd><p>Name of the layer for writing the polygon features. For
single-layer file formats such as <code>"ESRI Shapefile"</code>, the layer name is the
same as the filename without the path or extension (e.g., <code>out_dsn = "path_to_file/polygon_output.shp"</code>, the layer name is <code>"polygon_output"</code>).</p></dd>


<dt id="arg-fld-name">fld_name<a class="anchor" aria-label="anchor" href="#arg-fld-name"></a></dt>
<dd><p>Name of an integer attribute field in <code>out_layer</code> to which
the pixel values will be written. Will be created if necessary when using an
existing layer.</p></dd>


<dt id="arg-out-fmt">out_fmt<a class="anchor" aria-label="anchor" href="#arg-out-fmt"></a></dt>
<dd><p>GDAL short name of the output vector format. If unspecified,
the function will attempt to guess the format from the filename/connection
string.</p></dd>


<dt id="arg-connectedness">connectedness<a class="anchor" aria-label="anchor" href="#arg-connectedness"></a></dt>
<dd><p>Integer scalar. Must be either <code>4</code> or <code>8</code>. For the
default 4-connectedness, pixels with the same value are considered connected
only if they touch along one of the four sides, while 8-connectedness
also includes pixels that touch at one of the corners.</p></dd>


<dt id="arg-src-band">src_band<a class="anchor" aria-label="anchor" href="#arg-src-band"></a></dt>
<dd><p>The band on <code>raster_file</code> to build the polygons from
(default is <code>1</code>).</p></dd>


<dt id="arg-mask-file">mask_file<a class="anchor" aria-label="anchor" href="#arg-mask-file"></a></dt>
<dd><p>Use the first band of the specified raster as a
validity mask (zero is invalid, non-zero is valid). If not specified, the
default validity mask for the input band (such as nodata, or alpha masks)
will be used (unless <code>nomask</code> is set to <code>TRUE</code>).</p></dd>


<dt id="arg-nomask">nomask<a class="anchor" aria-label="anchor" href="#arg-nomask"></a></dt>
<dd><p>Logical scalar. If <code>TRUE</code>, do not use the default validity
mask for the input band (such as nodata, or alpha masks).
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical scalar. If <code>TRUE</code>, overwrite <code>out_layer</code> if it
already exists. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-dsco">dsco<a class="anchor" aria-label="anchor" href="#arg-dsco"></a></dt>
<dd><p>Optional character vector of format-specific creation options
for <code>out_dsn</code> (<code>"NAME=VALUE"</code> pairs).</p></dd>


<dt id="arg-lco">lco<a class="anchor" aria-label="anchor" href="#arg-lco"></a></dt>
<dd><p>Optional character vector of format-specific creation options
for <code>out_layer</code> (<code>"NAME=VALUE"</code> pairs).</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Logical scalar. If <code>TRUE</code>, a progress bar will not be
displayed. Defaults to <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Polygon features will be created on the output layer, with polygon
geometries representing the polygons. The polygon geometries will be in the
georeferenced coordinate system of the raster (based on the geotransform of
the source dataset). It is acceptable for the output layer to already have
features. If the output layer does not already exist, it will be created
with coordinate system matching the source raster.</p>
<p>The algorithm attempts to minimize memory use so that very large rasters can
be processed. However, if the raster has many polygons or very large/complex
polygons, the memory use for holding polygon enumerations and active polygon
geometries may grow to be quite large.</p>
<p>The algorithm will generally produce very dense polygon geometries, with
edges that follow exactly on pixel boundaries for all non-interior pixels.
For non-thematic raster data (such as satellite images) the result will
essentially be one small polygon per pixel, and memory and output layer
sizes will be substantial. The algorithm is primarily intended for
relatively simple thematic rasters, masks, and classification results.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The source pixel band values are read into a signed 64-bit integer buffer
(<code>Int64</code>) by <code>GDALPolygonize</code>, so floating point or complex bands will be
implicitly truncated before processing.</p>
<p>When 8-connectedness is used, many of the resulting polygons will likely be
invalid due to ring self-intersection (in the strict OGC definition of
polygon validity). They may be suitable as-is for certain purposes such as
calculating geometry attributes (area, perimeter). Package <strong>sf</strong> has
<code>st_make_valid()</code>, PostGIS has <code>ST_MakeValid()</code>, and QGIS has vector
processing utility "Fix geometries" (single polygons can become MultiPolygon
in the case of self-intersections).</p>
<p>If writing to a SQLite database format as either <code>GPKG</code> (GeoPackage
vector) or <code>SQLite</code> (Spatialite vector), setting the
<code>SQLITE_USE_OGR_VFS</code> and <code>OGR_SQLITE_JOURNAL</code> configuration options may
increase performance substantially. If writing to <code>PostgreSQL</code>
(PostGIS vector), setting <code>PG_USE_COPY=YES</code> is faster:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># SQLite: GPKG (.gpkg) and Spatialite (.sqlite)</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># enable extra buffering/caching by the GDAL/OGR I/O layer</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">set_config_option</span>(<span class="st">"SQLITE_USE_OGR_VFS"</span>, <span class="st">"YES"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># set the journal mode for the SQLite database to MEMORY</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">set_config_option</span>(<span class="st">"OGR_SQLITE_JOURNAL"</span>, <span class="st">"MEMORY"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># PostgreSQL / PostGIS</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># use COPY for inserting data rather than INSERT</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">set_config_option</span>(<span class="st">"PG_USE_COPY"</span>, <span class="st">"YES"</span>)</span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="rasterize.html">rasterize()</a></code></p>
<p><code><a href="../articles/gdal-config-quick-ref.html">vignette("gdal-config-quick-ref")</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">evt_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/storml_evt.tif"</span>, package<span class="op">=</span><span class="st">"gdalraster"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"storm_lake.gpkg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="st">"lf_evt"</span></span></span>
<span class="r-in"><span><span class="va">fld</span> <span class="op">&lt;-</span> <span class="st">"evt_value"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_config_option.html">set_config_option</a></span><span class="op">(</span><span class="st">"SQLITE_USE_OGR_VFS"</span>, <span class="st">"YES"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_config_option.html">set_config_option</a></span><span class="op">(</span><span class="st">"OGR_SQLITE_JOURNAL"</span>, <span class="st">"MEMORY"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">polygonize</span><span class="op">(</span><span class="va">evt_file</span>, <span class="va">dsn</span>, <span class="va">layer</span>, <span class="va">fld</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0...10...20...30...40...50...60...70...80...90...100 - done.</span>
<span class="r-in"><span><span class="fu"><a href="set_config_option.html">set_config_option</a></span><span class="op">(</span><span class="st">"SQLITE_USE_OGR_VFS"</span>, <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_config_option.html">set_config_option</a></span><span class="op">(</span><span class="st">"OGR_SQLITE_JOURNAL"</span>, <span class="st">""</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/ctoney" class="external-link">Chris Toney</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

