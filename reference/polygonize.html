<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="polygonize() creates vector polygons for all connected regions of pixels
in a source raster sharing a common pixel value. Each polygon is created
with an attribute indicating the pixel value of that polygon. A raster mask
may also be provided to determine which pixels are eligible for processing.
The function will create the output vector layer if it does not already
exist, otherwise it will try to append to an existing one.
This function is a wrapper of GDALPolygonize in the GDAL Algorithms API.
It provides essentially the same functionality as the gdal_polygonize.py
command-line program (https://gdal.org/programs/gdal_polygonize.html)."><title>Create a polygon feature layer from raster data — polygonize • gdalraster</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a polygon feature layer from raster data — polygonize"><meta property="og:description" content="polygonize() creates vector polygons for all connected regions of pixels
in a source raster sharing a common pixel value. Each polygon is created
with an attribute indicating the pixel value of that polygon. A raster mask
may also be provided to determine which pixels are eligible for processing.
The function will create the output vector layer if it does not already
exist, otherwise it will try to append to an existing one.
This function is a wrapper of GDALPolygonize in the GDAL Algorithms API.
It provides essentially the same functionality as the gdal_polygonize.py
command-line program (https://gdal.org/programs/gdal_polygonize.html)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gdalraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/gdal-block-cache.html">GDAL Block Cache</a>
    <a class="dropdown-item" href="../articles/raster-display.html">Raster Display</a>
    <a class="dropdown-item" href="../articles/gdal-config-quick-ref.html">GDAL Config Quick Reference</a>
    <a class="dropdown-item" href="../articles/raster-api-tutorial.html">Raster API Tutorial</a>
    <a class="dropdown-item" href="../articles/raster-attribute-tables.html">Raster Attribute Tables</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USDAForestService/gdalraster/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create a polygon feature layer from raster data</h1>
      <small class="dont-index">Source: <a href="https://github.com/USDAForestService/gdalraster/blob/HEAD/R/gdalraster_proc.R" class="external-link"><code>R/gdalraster_proc.R</code></a></small>
      <div class="d-none name"><code>polygonize.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>polygonize()</code> creates vector polygons for all connected regions of pixels
in a source raster sharing a common pixel value. Each polygon is created
with an attribute indicating the pixel value of that polygon. A raster mask
may also be provided to determine which pixels are eligible for processing.
The function will create the output vector layer if it does not already
exist, otherwise it will try to append to an existing one.
This function is a wrapper of <code>GDALPolygonize</code> in the GDAL Algorithms API.
It provides essentially the same functionality as the <code>gdal_polygonize.py</code>
command-line program (<a href="https://gdal.org/programs/gdal_polygonize.html" class="external-link">https://gdal.org/programs/gdal_polygonize.html</a>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">polygonize</span><span class="op">(</span></span>
<span>  <span class="va">raster_file</span>,</span>
<span>  <span class="va">out_dsn</span>,</span>
<span>  <span class="va">out_layer</span>,</span>
<span>  fld_name <span class="op">=</span> <span class="st">"DN"</span>,</span>
<span>  out_fmt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  connectedness <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  src_band <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mask_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nomask <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dsco <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lco <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>raster_file</dt>
<dd><p>Filename of the source raster.</p></dd>


<dt>out_dsn</dt>
<dd><p>The destination vector filename to which the polygons will be
written (or database connection string).</p></dd>


<dt>out_layer</dt>
<dd><p>Name of the layer for writing the polygon features. For
single-layer file formats such as <code>"ESRI Shapefile"</code>, the layer name is the
same as the filename without the path or extension (e.g., <code>out_dsn = "path_to_file/polygon_output.shp"</code>, the layer name is <code>"polygon_output"</code>).</p></dd>


<dt>fld_name</dt>
<dd><p>Name of an integer attribute field in <code>out_layer</code> to which
the pixel values will be written. Will be created if necessary when using an
existing layer.</p></dd>


<dt>out_fmt</dt>
<dd><p>GDAL short name of the output vector format. If unspecified,
the function will attempt to guess the format from the filename/connection
string.</p></dd>


<dt>connectedness</dt>
<dd><p>Integer scalar. Must be either <code>4</code> or <code>8</code>. For the
default 4-connectedness, pixels with the same value are considered connected
only if they touch along one of the four sides, while 8-connectedness
also includes pixels that touch at one of the corners.</p></dd>


<dt>src_band</dt>
<dd><p>The band on <code>raster_file</code> to build the polygons from
(default is <code>1</code>).</p></dd>


<dt>mask_file</dt>
<dd><p>Use the first band of the specified raster as a
validity mask (zero is invalid, non-zero is valid). If not specified, the
default validity mask for the input band (such as nodata, or alpha masks)
will be used (unless <code>nomask</code> is set to <code>TRUE</code>).</p></dd>


<dt>nomask</dt>
<dd><p>Logical scalar. If <code>TRUE</code>, do not use the default validity
mask for the input band (such as nodata, or alpha masks).
Default is <code>FALSE</code>.</p></dd>


<dt>overwrite</dt>
<dd><p>Logical scalar. If <code>TRUE</code>, overwrite <code>out_layer</code> if it
already exists. Default is <code>FALSE</code>.</p></dd>


<dt>dsco</dt>
<dd><p>Optional character vector of format-specific creation options
for <code>out_dsn</code> (<code>"NAME=VALUE"</code> pairs).</p></dd>


<dt>lco</dt>
<dd><p>Optional character vector of format-specific creation options
for <code>out_layer</code> (<code>"NAME=VALUE"</code> pairs).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Polygon features will be created on the output layer, with polygon
geometries representing the polygons. The polygon geometries will be in the
georeferenced coordinate system of the raster (based on the geotransform of
the source dataset). It is acceptable for the output layer to already have
features. If the output layer does not already exist, it will be created
with coordinate system matching the source raster.</p>
<p>The algorithm attempts to minimize memory use so that very large rasters can
be processed. However, if the raster has many polygons or very large/complex
polygons, the memory use for holding polygon enumerations and active polygon
geometries may grow to be quite large.</p>
<p>The algorithm will generally produce very dense polygon geometries, with
edges that follow exactly on pixel boundaries for all non-interior pixels.
For non-thematic raster data (such as satellite images) the result will
essentially be one small polygon per pixel, and memory and output layer
sizes will be substantial. The algorithm is primarily intended for
relatively simple thematic rasters, masks, and classification results.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The source pixel band values are read into a signed 64-bit integer buffer
(<code>Int64</code>) by <code>GDALPolygonize</code>, so floating point or complex bands will be
implicitly truncated before processing.</p>
<p>When 8-connectedness is used, many of the resulting polygons will likely be
invalid due to ring self-intersection (in the strict OGC definition of
polygon validity). They may be suitable as-is for certain purposes such as
calculating geometry attributes (area, perimeter). Package <strong>sf</strong> has
<code>st_make_valid()</code>, PostGIS has <code>ST_MakeValid()</code>, and QGIS has vector
processing utility "Fix geometries" (single polygons can become MultiPolygon
in the case of self-intersections).</p>
<p>If writing to a SQLite database format as either <code>GPKG</code> (GeoPackage
vector) or <code>SQLite</code> (Spatialite vector), setting the
<code>SQLITE_USE_OGR_VFS</code> and <code>OGR_SQLITE_JOURNAL</code> configuration options may
increase performance substantially. If writing to <code>PostgreSQL</code>
(PostGIS vector), setting <code>PG_USE_COPY=YES</code> is faster:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SQLite: GPKG (.gpkg) and Spatialite (.sqlite)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># enable extra buffering/caching by the GDAL/OGR I/O layer</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set_config_option</span>(<span class="st">"SQLITE_USE_OGR_VFS"</span>, <span class="st">"YES"</span>)<span class="er">}</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set the journal mode for the SQLite database to MEMORY</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set_config_option</span>(<span class="st">"OGR_SQLITE_JOURNAL"</span>, <span class="st">"MEMORY"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># PostgreSQL / PostGIS</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># use COPY for inserting data rather than INSERT</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set_config_option</span>(<span class="st">"PG_USE_COPY"</span>, <span class="st">"YES"</span>)</span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="rasterize.html">rasterize()</a></code></p>
<p><code><a href="../articles/gdal-config-quick-ref.html">vignette("gdal-config-quick-ref")</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">evt_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/storml_evt.tif"</span>, package<span class="op">=</span><span class="st">"gdalraster"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="st">"storm_lake.gpkg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="st">"lf_evt"</span></span></span>
<span class="r-in"><span><span class="va">fld</span> <span class="op">&lt;-</span> <span class="st">"evt_value"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_config_option.html">set_config_option</a></span><span class="op">(</span><span class="st">"SQLITE_USE_OGR_VFS"</span>, <span class="st">"YES"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_config_option.html">set_config_option</a></span><span class="op">(</span><span class="st">"OGR_SQLITE_JOURNAL"</span>, <span class="st">"MEMORY"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">polygonize</span><span class="op">(</span><span class="va">evt_file</span>, <span class="va">dsn</span>, <span class="va">layer</span>, <span class="va">fld</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0...10...20...30...40...50...60...70...80...90...100 - done.</span>
<span class="r-in"><span><span class="fu"><a href="set_config_option.html">set_config_option</a></span><span class="op">(</span><span class="st">"SQLITE_USE_OGR_VFS"</span>, <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_config_option.html">set_config_option</a></span><span class="op">(</span><span class="st">"OGR_SQLITE_JOURNAL"</span>, <span class="st">""</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://github.com/ctoney" class="external-link">Chris Toney</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

