<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="sieveFilter() is a wrapper for GDALSieveFilter() in the GDAL Algorithms
API. It removes raster polygons smaller than a provided threshold size
(in pixels) and replaces them with the pixel value of the largest neighbour
polygon."><title>Remove small raster polygons — sieveFilter • gdalraster</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Remove small raster polygons — sieveFilter"><meta property="og:description" content="sieveFilter() is a wrapper for GDALSieveFilter() in the GDAL Algorithms
API. It removes raster polygons smaller than a provided threshold size
(in pixels) and replaces them with the pixel value of the largest neighbour
polygon."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gdalraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/gdal-block-cache.html">GDAL Block Cache</a>
    <a class="dropdown-item" href="../articles/raster-display.html">Raster Display</a>
    <a class="dropdown-item" href="../articles/raster-api-tutorial.html">Raster API Tutorial</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USDAForestService/gdalraster/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Remove small raster polygons</h1>
      <small class="dont-index">Source: <a href="https://github.com/USDAForestService/gdalraster/blob/HEAD/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
      <div class="d-none name"><code>sieveFilter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>sieveFilter()</code> is a wrapper for <code>GDALSieveFilter()</code> in the GDAL Algorithms
API. It removes raster polygons smaller than a provided threshold size
(in pixels) and replaces them with the pixel value of the largest neighbour
polygon.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sieveFilter</span><span class="op">(</span></span>
<span>  <span class="va">src_filename</span>,</span>
<span>  <span class="va">src_band</span>,</span>
<span>  <span class="va">dst_filename</span>,</span>
<span>  <span class="va">dst_band</span>,</span>
<span>  <span class="va">size_threshold</span>,</span>
<span>  <span class="va">connectedness</span>,</span>
<span>  mask_filename <span class="op">=</span> <span class="st">""</span>,</span>
<span>  mask_band <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  options <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>src_filename</dt>
<dd><p>Filename of the source raster to be processed.</p></dd>


<dt>src_band</dt>
<dd><p>Band number in the source raster to be processed.</p></dd>


<dt>dst_filename</dt>
<dd><p>Filename of the output raster. It may be the same as
<code>src_filename</code> to update the source file in place.</p></dd>


<dt>dst_band</dt>
<dd><p>Band number in <code>dst_filename</code> to write output. It may be
the same as <code>src_band</code> to update the source raster in place.</p></dd>


<dt>size_threshold</dt>
<dd><p>Integer. Raster polygons with sizes (in pixels)
smaller than this value will be merged into their largest neighbour.</p></dd>


<dt>connectedness</dt>
<dd><p>Integer. Either <code>4</code> indicating that diagonal pixels
are not considered directly adjacent for polygon membership purposes, or
<code>8</code> indicating they are.</p></dd>


<dt>mask_filename</dt>
<dd><p>Optional filename of raster to use as a mask.</p></dd>


<dt>mask_band</dt>
<dd><p>Band number in <code>mask_filename</code> to use as a mask. All
pixels in the mask band with a value other than zero will be considered
suitable for inclusion in polygons.</p></dd>


<dt>options</dt>
<dd><p>Algorithm options as a character vector of name=value pairs.
None currently supported.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Logical indicating success (invisible <code>TRUE</code>).
An error is raised if the operation fails.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Polygons are determined as regions of the raster where the pixels all have
the same value, and that are contiguous (connected).
Pixels determined to be "nodata" per the mask band will not be
treated as part of a polygon regardless of their pixel values. Nodata areas
will never be changed nor affect polygon sizes. Polygons smaller than the
threshold with no neighbours that are as large as the threshold will not be
altered. Polygons surrounded by nodata areas will therefore not be altered.</p>
<p>The algorithm makes three passes over the input file to enumerate the
polygons and collect limited information about them. Memory use is
proportional to the number of polygons (roughly 24 bytes per polygon), but
is not directly related to the size of the raster. So very large raster
files can be processed effectively if there aren't too many polygons. But
extremely noisy rasters with many one pixel polygons will end up being
expensive (in memory) to process.</p>
<p>The input dataset is read as integer data which means that floating point
values are rounded to integers.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## remove single-pixel polygons from the vegetation type layer (EVT)</span></span></span>
<span class="r-in"><span><span class="va">evt_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/storml_evt.tif"</span>, package<span class="op">=</span><span class="st">"gdalraster"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a blank raster to hold the output</span></span></span>
<span class="r-in"><span><span class="va">evt_mmu_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="st">"storml_evt_mmu2.tif"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="rasterFromRaster.html">rasterFromRaster</a></span><span class="op">(</span>srcfile <span class="op">=</span> <span class="va">evt_file</span>,</span></span>
<span class="r-in"><span>                 dstfile <span class="op">=</span> <span class="va">evt_mmu_file</span>,</span></span>
<span class="r-in"><span>                 init <span class="op">=</span> <span class="fl">32767</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Initializing destination raster...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a mask to exclude water pixels from the algorithm</span></span></span>
<span class="r-in"><span><span class="co"># recode water (7292) to 0</span></span></span>
<span class="r-in"><span><span class="va">expr</span> <span class="op">&lt;-</span> <span class="st">"ifelse(EVT == 7292, 0, EVT)"</span></span></span>
<span class="r-in"><span><span class="va">mask_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calc.html">calc</a></span><span class="op">(</span>expr <span class="op">=</span> <span class="va">expr</span>,</span></span>
<span class="r-in"><span>                  rasterfiles <span class="op">=</span> <span class="va">evt_file</span>,</span></span>
<span class="r-in"><span>                  var.names <span class="op">=</span> <span class="st">"EVT"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating from 1 input layer(s)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Output written to: /tmp/RtmpZa8Orm/rastcalc1ecc6ca8ea1d.tif</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a version of EVT with two-pixel minimum mapping unit</span></span></span>
<span class="r-in"><span><span class="fu">sieveFilter</span><span class="op">(</span>src_filename <span class="op">=</span> <span class="va">evt_file</span>,</span></span>
<span class="r-in"><span>            src_band <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            dst_filename <span class="op">=</span> <span class="va">evt_mmu_file</span>,</span></span>
<span class="r-in"><span>            dst_band <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            size_threshold <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>            connectedness <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>            mask_filename <span class="op">=</span> <span class="va">mask_file</span>,</span></span>
<span class="r-in"><span>            mask_band <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0...10...20...30...40...50...60...70...80...90...100 - done.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://github.com/ctoney" class="external-link">Chris Toney</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

