<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gdalraster">
<title>Draft Bindings to the GDAL/OGR Vector API • gdalraster</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Draft Bindings to the GDAL/OGR Vector API">
<meta property="og:description" content="gdalraster">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gdalraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10.9150</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/gdal-block-cache.html">GDAL Block Cache</a>
    <a class="dropdown-item" href="../articles/gdal-config-quick-ref.html">GDAL Config Quick Reference</a>
    <a class="dropdown-item" href="../articles/gdalvector-draft.html">Draft Bindings to the GDAL/OGR Vector API</a>
    <a class="dropdown-item" href="../articles/raster-api-tutorial.html">Raster API Tutorial</a>
    <a class="dropdown-item" href="../articles/raster-attribute-tables.html">Raster Attribute Tables</a>
    <a class="dropdown-item" href="../articles/raster-display.html">Raster Display</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USDAForestService/gdalraster/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Draft Bindings to the GDAL/OGR Vector API</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/USDAForestService/gdalraster/blob/HEAD/vignettes/articles/gdalvector-draft.Rmd" class="external-link"><code>vignettes/articles/gdalvector-draft.Rmd</code></a></small>
      <div class="d-none name"><code>gdalvector-draft.Rmd</code></div>
    </div>

    
    
<p>Chris Toney (chris.toney at usda.gov)</p>
<p>Last modified: 2024-04-28</p>
<p>Comment/discussion: <a href="https://github.com/USDAForestService/gdalraster/issues/241" class="external-link uri">https://github.com/USDAForestService/gdalraster/issues/241</a></p>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This document describes R bindings to the GDAL/OGR Vector API
proposed for inclusion in package <strong>gdalraster</strong>, analogous
to its existing raster support. A package providing low-level access to
both the raster and vector APIs in GDAL should be of interest to
developers creating higher level interfaces. For example, custom
workflows that are I/O intensive may benefit from direct access to
GDAL’s I/O capabilities. R bindings to the vector API would support
persistent connections to the data store, cursors with attribute and
spatial filtering, transactions, feature-level insert/delete, update of
attributes and geometries, and OGR facilities for geoprocessing. Calling
signatures of a class-based interface will resemble the C++ and Python
APIs provided by the GDAL project. It is intended that bindings in
<strong>gdalraster</strong> should provide long-term API stability while
tracking changes in GDAL.</p>
<p>A proposed interface is described in terms of the <a href="https://gdal.org/user/vector_data_model.html" class="external-link">GDAL Vector Data
Model</a>, along with a draft class definition for implementation via
<code>RCPP_EXPOSED_CLASS</code>. A prototype of the bindings is in the
<code>gdalvector</code> branch at <a href="https://github.com/USDAForestService/gdalraster/tree/gdalvector" class="external-link uri">https://github.com/USDAForestService/gdalraster/tree/gdalvector</a>.
The prototype bindings are currently undocumented. Code examples are
included here to demonstrate usage and proof-of-concept. Installation of
the development version of <strong>gdalraster</strong> containing the
prototype vector bindings could be done with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"USDAForestService/gdalraster"</span>, ref <span class="op">=</span> <span class="st">"gdalvector"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="description-of-the-interface">Description of the interface<a class="anchor" aria-label="anchor" href="#description-of-the-interface"></a>
</h2>
<p>Bindings will be implemented with <strong>Rcpp</strong> modules
including <code>RCPP_EXPOSED_CLASS</code>. Exposing C++ classes directly
in R provides a natural interface to the underlying object model.</p>
<p>A GDAL Dataset for vector is a file or database containing one or
more OGR layers. A vector dataset is represented in R as a data source
name (DSN), a character string that may be a filename, database
connection string, URL, virtual file, etc. Management of datasets and
their vector schemas will be done with:</p>
<ul>
<li>existing management functions in <strong>gdalraster</strong> that
operate on vector datasets: <code><a href="../reference/copyDatasetFiles.html">copyDatasetFiles()</a></code>,
<code><a href="../reference/deleteDataset.html">deleteDataset()</a></code>, <code><a href="../reference/renameDataset.html">renameDataset()</a></code> and
<code><a href="../reference/addFilesInZip.html">addFilesInZip()</a></code> (supports SOZip)</li>
<li>existing internal utility functions to be further developed
(potentially renamed/refactored): <code>.ogr_ds_exists()</code>,
<code>.create_ogr()</code>, <code>.ogr_ds_layer_count()</code>,
<code>.ogr_layer_exists()</code>, <code>.ogr_layer_create()</code>,
<code>.ogr_layer_delete()</code> <code>.ogr_field_index()</code>,
<code>.ogr_field_create()</code>
</li>
<li>existing wrappers <code><a href="../reference/ogr2ogr.html">ogr2ogr()</a></code> and <code><a href="../reference/ogrinfo.html">ogrinfo()</a></code>
from the gdal_utils.h API (<strong>gdalraster</strong> 1.10.0 CRAN
release)</li>
<li>add <code>ogr_execute_sql()</code>: execute an SQL statement against
the data store for <code>CREATE INDEX</code>, <code>DROP INDEX</code>,
<code>ALTER TABLE</code>, <code>DROP TABLE</code> (a SQL
<code>SELECT</code> statement can be used in the constructor for class
<code>GDALVector</code> described below, to open a layer of
features)</li>
<li>other stand-alone functions TBD</li>
</ul>
<p>OGR Layer class represents a layer of features within a data source.
It will be modeled in R as class <code>GDALVector</code>, an exposed C++
class encapsulating an OGR Layer and the GDAL Dataset that owns it. A
<code>GDALVector</code> object will persist an open connection to the
dataset and expose methods for retrieving layer information, setting
attribute and spatial filters, reading/writing features, and layer
geoprocessing. A draft definition for class <code>GDALVector</code> is
given below.</p>
<p>All features in an OGR Layer share a common schema (feature class)
modeled in GDAL as OGR Feature Definition. A feature class definition
includes the set of attribute fields and their data types, the geometry
field(s), and a feature class name (normally used as a layer name). The
feature class definition is represented as a list in R, having as names
the attribute/geometry field names, with each list element holding a
field definition.</p>
<p>An attribute field definition is a list with named elements:</p>
<pre><code>$type       : OGR Field Type ("OFTString", "OFTInteger", ...)
$subtype    : optional ("OFSTBoolean", ...)
$width      : optional max number of characters
$precision  : optional number of digits after the decimal point
$is_nullable: optional NOT NULL constraint (logical scalar)
$is_unique  : optional UNIQUE constraint (logical scalar)
$default    : optional field default value as character string
$is_ignored : whether ignored when retrieving features (logical scalar)
$domain     : optional domain name
$is_geom    : FALSE for attribute fields</code></pre>
<p>A geometry field definition is a list with named elements:</p>
<pre><code>$type       : geom type ("Point", "Polygon", etc.)
$srs        : optional spatial reference as WKT string
$is_nullable: optional NOT NULL constraint (logical scalar)
$is_ignored : whether ignored when retrieving features (logical scalar)
$is_geom    : TRUE for geometry fields</code></pre>
<p>An OGR Feature – as read by <code>GDALVector::getNextFeature()</code>
or <code>GDALVector::getFeature()</code>, or as passed to write methods
– is a list with the unique feature identifier (FID), attribute and
geometry field names, and their values.
<code>GDALVector::getFeatureSet()</code> will return a set of features
as a data frame.</p>
<p>An OGR Geometry is represented in R as a character string containing
OGC Well Known Text (WKT). Likewise, an OGR Spatial Reference, which
encapsulates the definition of a projection and datum, is represented in
R as WKT. <strong>gdalraster</strong> has existing functions for working
with spatial reference systems as WKT (<code><a href="../reference/srs_to_wkt.html">srs_to_wkt()</a></code>,
<code><a href="../reference/srs_is_projected.html">srs_is_projected()</a></code>, etc.), and a set of geometry
convenience functions also operating on WKT (GEOS via GDAL headers).</p>
</div>
<div class="section level2">
<h2 id="class-gdalvector">class GDALVector<a class="anchor" aria-label="anchor" href="#class-gdalvector"></a>
</h2>
<p>The draft class definition below has been partially implemented
in:</p>
<p><a href="https://github.com/USDAForestService/gdalraster/blob/gdalvector/src/gdalvector.cpp" class="external-link uri">https://github.com/USDAForestService/gdalraster/blob/gdalvector/src/gdalvector.cpp</a></p>
<p>The header file can be referenced for the public class methods that
have been implemented so far in the prototype (a subset of the draft
class definition below):</p>
<p><a href="https://github.com/USDAForestService/gdalraster/blob/gdalvector/src/gdalvector.h" class="external-link uri">https://github.com/USDAForestService/gdalraster/blob/gdalvector/src/gdalvector.h</a></p>
<p>This does not include definitions of several stand-alone functions
that will provide schema management. The existing definitions in
<code>src/ogr_util.h</code> are a starting point for those. An
<strong>Rcpp</strong> <code>.finalizer</code> function will be
implemented to properly release resources in case an object of class
<code>GDALVector</code> is garbage collected without an explicit call to
<code><a href="https://rdrr.io/r/base/connections.html" class="external-link">close()</a></code>. Support for 64-bit integers requires
<strong>bit64</strong> on the R side, with conversions in C++ using
<strong>RcppInt64</strong>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="kw">class</span> GDALVector <span class="op">{</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a> <span class="kw">private</span><span class="op">:</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    <span class="bu">std::</span>string dsn_in<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="bu">std::</span>string layer_in<span class="op">;</span>  <span class="co">// layer name or sql statement</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="dt">bool</span> is_sql_in<span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    Rcpp<span class="op">::</span>CharacterVector open_options_in<span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    <span class="bu">std::</span>string spatial_filter_in<span class="op">;</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    <span class="bu">std::</span>string dialect_in<span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    GDALDatasetH hDataset<span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    GDALAccess eAccess<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    OGRLayerH hLayer<span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    OGRFeatureDefnH hFDefn<span class="op">;</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a> <span class="kw">public</span><span class="op">:</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>    GDALVector<span class="op">();</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>    <span class="kw">explicit</span> GDALVector<span class="op">(</span>Rcpp<span class="op">::</span>CharacterVector dsn<span class="op">);</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>    GDALVector<span class="op">(</span>Rcpp<span class="op">::</span>CharacterVector dsn<span class="op">,</span> <span class="bu">std::</span>string layer<span class="op">);</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>    GDALVector<span class="op">(</span>Rcpp<span class="op">::</span>CharacterVector dsn<span class="op">,</span> <span class="bu">std::</span>string layer<span class="op">,</span> <span class="dt">bool</span> read_only<span class="op">);</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>    GDALVector<span class="op">(</span>Rcpp<span class="op">::</span>CharacterVector dsn<span class="op">,</span> <span class="bu">std::</span>string layer<span class="op">,</span> <span class="dt">bool</span> read_only<span class="op">,</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>               Rcpp<span class="op">::</span>CharacterVector open_options<span class="op">);</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>    GDALVector<span class="op">(</span>Rcpp<span class="op">::</span>CharacterVector dsn<span class="op">,</span> <span class="bu">std::</span>string layer<span class="op">,</span> <span class="dt">bool</span> read_only<span class="op">,</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>               Rcpp<span class="op">::</span>Nullable<span class="op">&lt;</span>Rcpp<span class="op">::</span>CharacterVector<span class="op">&gt;</span> open_options<span class="op">,</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>               <span class="bu">std::</span>string spatial_filter<span class="op">,</span> <span class="bu">std::</span>string dialect<span class="op">);</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>    <span class="dt">void</span> open<span class="op">(</span><span class="dt">bool</span> read_only<span class="op">);</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>    <span class="dt">bool</span> isOpen<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>    <span class="bu">std::</span>string getDsn<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>    Rcpp<span class="op">::</span>CharacterVector getFileList<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>    <span class="bu">std::</span>string getDriverShortName<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>    <span class="bu">std::</span>string getDriverLongName<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>    <span class="bu">std::</span>string getName<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a>    <span class="dt">bool</span> testCapability<span class="op">(</span><span class="bu">std::</span>string capability<span class="op">)</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a>    <span class="bu">std::</span>string getFIDColumn<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>    <span class="bu">std::</span>string getGeomType<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>    <span class="bu">std::</span>string getGeometryColumn<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a>    <span class="bu">std::</span>string getSpatialRef<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>    Rcpp<span class="op">::</span>NumericVector bbox<span class="op">();</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a>    Rcpp<span class="op">::</span>List getLayerDefn<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a>    <span class="dt">void</span> setAttributeFilter<span class="op">(</span><span class="bu">std::</span>string query<span class="op">);</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a>    <span class="dt">void</span> setSpatialFilterRect<span class="op">(</span>Rcpp<span class="op">::</span>NumericVector bbox<span class="op">);</span></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a>    <span class="dt">void</span> setSpatialFilter<span class="op">(</span><span class="bu">std::</span>string wkt<span class="op">);</span></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a>    <span class="bu">std::</span>string getSpatialFilter<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a>    <span class="dt">void</span> clearSpatialFilter<span class="op">();</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a></span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a>    <span class="dt">double</span> getFeatureCount<span class="op">();</span></span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a>    SEXP getNextFeature<span class="op">();</span></span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a>    <span class="dt">void</span> resetReading<span class="op">();</span></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a>    SEXP getFeature<span class="op">(</span><span class="dt">int64_t</span> fid<span class="op">);</span></span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a>    <span class="dt">void</span> setNextByIndex<span class="op">(</span><span class="dt">int64_t</span> fid<span class="op">);</span></span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a>    <span class="dt">void</span> setIgnoredFields<span class="op">(</span>Rcpp<span class="op">::</span>CharacterVector fields<span class="op">);</span></span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a></span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a>    Rcpp<span class="op">::</span>DataFrame getFeatureSet<span class="op">(</span>Rcpp<span class="op">::</span>CharacterVector fields<span class="op">,</span></span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a>                                  <span class="dt">bool</span> geom_column<span class="op">);</span></span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a></span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a>    <span class="co">// initialize an empty feature as list:</span></span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a>    Rcpp<span class="op">::</span>List initFeature<span class="op">();</span></span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a>    <span class="co">// the following return the FID of the affected feature if successful</span></span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a>    <span class="co">// create and write a new feature within a layer:</span></span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a>    <span class="dt">int64_t</span> createFeature<span class="op">(</span>Rcpp<span class="op">::</span>List feat<span class="op">);</span></span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a>    <span class="co">// rewrite/replace an existing feature:</span></span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a>    <span class="dt">int64_t</span> setFeature<span class="op">(</span>Rcpp<span class="op">::</span>List feat<span class="op">);</span></span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a>    <span class="co">// rewrite/replace an existing feature or create a new feature:</span></span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a>    <span class="dt">int64_t</span> upsertFeature<span class="op">(</span>Rcpp<span class="op">::</span>List feat<span class="op">);</span></span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a>    <span class="co">// delete feature from layer:</span></span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a>    <span class="dt">int64_t</span> deleteFeature<span class="op">(</span><span class="dt">int64_t</span> fid<span class="op">);</span></span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a></span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a>    <span class="dt">bool</span> startTransaction<span class="op">(</span><span class="dt">bool</span> force<span class="op">);</span></span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a>    <span class="dt">bool</span> commitTransaction<span class="op">();</span></span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a>    <span class="dt">bool</span> rollbackTransaction<span class="op">();</span></span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a></span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a>    <span class="dt">void</span> layerIntersection<span class="op">(</span></span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a>            GDALVector method_layer<span class="op">,</span></span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a>            GDALVector result_layer<span class="op">,</span></span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a>            <span class="dt">bool</span> quiet<span class="op">,</span></span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a>            Rcpp<span class="op">::</span>Nullable<span class="op">&lt;</span>Rcpp<span class="op">::</span>CharacterVector<span class="op">&gt;</span> options<span class="op">);</span></span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a>    <span class="dt">void</span> layerUnion<span class="op">(</span></span>
<span id="cb4-79"><a href="#cb4-79" tabindex="-1"></a>            GDALVector method_layer<span class="op">,</span></span>
<span id="cb4-80"><a href="#cb4-80" tabindex="-1"></a>            GDALVector result_layer<span class="op">,</span></span>
<span id="cb4-81"><a href="#cb4-81" tabindex="-1"></a>            <span class="dt">bool</span> quiet<span class="op">,</span></span>
<span id="cb4-82"><a href="#cb4-82" tabindex="-1"></a>            Rcpp<span class="op">::</span>Nullable<span class="op">&lt;</span>Rcpp<span class="op">::</span>CharacterVector<span class="op">&gt;</span> options<span class="op">);</span></span>
<span id="cb4-83"><a href="#cb4-83" tabindex="-1"></a>    <span class="dt">void</span> layerSymDifference<span class="op">(</span></span>
<span id="cb4-84"><a href="#cb4-84" tabindex="-1"></a>            GDALVector method_layer<span class="op">,</span></span>
<span id="cb4-85"><a href="#cb4-85" tabindex="-1"></a>            GDALVector result_layer<span class="op">,</span></span>
<span id="cb4-86"><a href="#cb4-86" tabindex="-1"></a>            <span class="dt">bool</span> quiet<span class="op">,</span></span>
<span id="cb4-87"><a href="#cb4-87" tabindex="-1"></a>            Rcpp<span class="op">::</span>Nullable<span class="op">&lt;</span>Rcpp<span class="op">::</span>CharacterVector<span class="op">&gt;</span> options<span class="op">);</span></span>
<span id="cb4-88"><a href="#cb4-88" tabindex="-1"></a>    <span class="dt">void</span> layerIdentity<span class="op">(</span></span>
<span id="cb4-89"><a href="#cb4-89" tabindex="-1"></a>            GDALVector method_layer<span class="op">,</span></span>
<span id="cb4-90"><a href="#cb4-90" tabindex="-1"></a>            GDALVector result_layer<span class="op">,</span></span>
<span id="cb4-91"><a href="#cb4-91" tabindex="-1"></a>            <span class="dt">bool</span> quiet<span class="op">,</span></span>
<span id="cb4-92"><a href="#cb4-92" tabindex="-1"></a>            Rcpp<span class="op">::</span>Nullable<span class="op">&lt;</span>Rcpp<span class="op">::</span>CharacterVector<span class="op">&gt;</span> options<span class="op">);</span></span>
<span id="cb4-93"><a href="#cb4-93" tabindex="-1"></a>    <span class="dt">void</span> layerUpdate<span class="op">(</span></span>
<span id="cb4-94"><a href="#cb4-94" tabindex="-1"></a>            GDALVector method_layer<span class="op">,</span></span>
<span id="cb4-95"><a href="#cb4-95" tabindex="-1"></a>            GDALVector result_layer<span class="op">,</span></span>
<span id="cb4-96"><a href="#cb4-96" tabindex="-1"></a>            <span class="dt">bool</span> quiet<span class="op">,</span></span>
<span id="cb4-97"><a href="#cb4-97" tabindex="-1"></a>            Rcpp<span class="op">::</span>Nullable<span class="op">&lt;</span>Rcpp<span class="op">::</span>CharacterVector<span class="op">&gt;</span> options<span class="op">);</span></span>
<span id="cb4-98"><a href="#cb4-98" tabindex="-1"></a>    <span class="dt">void</span> layerClip<span class="op">(</span></span>
<span id="cb4-99"><a href="#cb4-99" tabindex="-1"></a>            GDALVector method_layer<span class="op">,</span></span>
<span id="cb4-100"><a href="#cb4-100" tabindex="-1"></a>            GDALVector result_layer<span class="op">,</span></span>
<span id="cb4-101"><a href="#cb4-101" tabindex="-1"></a>            <span class="dt">bool</span> quiet<span class="op">,</span></span>
<span id="cb4-102"><a href="#cb4-102" tabindex="-1"></a>            Rcpp<span class="op">::</span>Nullable<span class="op">&lt;</span>Rcpp<span class="op">::</span>CharacterVector<span class="op">&gt;</span> options<span class="op">);</span></span>
<span id="cb4-103"><a href="#cb4-103" tabindex="-1"></a>    <span class="dt">void</span> layerErase<span class="op">(</span></span>
<span id="cb4-104"><a href="#cb4-104" tabindex="-1"></a>            GDALVector method_layer<span class="op">,</span></span>
<span id="cb4-105"><a href="#cb4-105" tabindex="-1"></a>            GDALVector result_layer<span class="op">,</span></span>
<span id="cb4-106"><a href="#cb4-106" tabindex="-1"></a>            <span class="dt">bool</span> quiet<span class="op">,</span></span>
<span id="cb4-107"><a href="#cb4-107" tabindex="-1"></a>            Rcpp<span class="op">::</span>Nullable<span class="op">&lt;</span>Rcpp<span class="op">::</span>CharacterVector<span class="op">&gt;</span> options<span class="op">);</span></span>
<span id="cb4-108"><a href="#cb4-108" tabindex="-1"></a></span>
<span id="cb4-109"><a href="#cb4-109" tabindex="-1"></a>    <span class="dt">void</span> close<span class="op">();</span></span>
<span id="cb4-110"><a href="#cb4-110" tabindex="-1"></a></span>
<span id="cb4-111"><a href="#cb4-111" tabindex="-1"></a>    <span class="co">// methods for internal use not exported to R</span></span>
<span id="cb4-112"><a href="#cb4-112" tabindex="-1"></a>    <span class="dt">void</span> _checkAccess<span class="op">(</span>GDALAccess access_needed<span class="op">)</span> <span class="at">const</span><span class="op">;</span></span>
<span id="cb4-113"><a href="#cb4-113" tabindex="-1"></a>    OGRLayerH _getOGRLayerH<span class="op">();</span></span>
<span id="cb4-114"><a href="#cb4-114" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb4-115"><a href="#cb4-115" tabindex="-1"></a></span>
<span id="cb4-116"><a href="#cb4-116" tabindex="-1"></a>RCPP_EXPOSED_CLASS<span class="op">(</span>GDALVector<span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-usage-for-class-gdalvector">Example: usage for class GDALVector<a class="anchor" aria-label="anchor" href="#example-usage-for-class-gdalvector"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## usage for GDALVector class</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usdaforestservice.github.io/gdalraster/">gdalraster</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; GDAL 3.8.4, released 2024/02/08, GEOS 3.12.1, PROJ 9.3.1</span></span>
<span></span>
<span><span class="co"># MTBS fires in Yellowstone National Park 1984-2022</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/ynp_fires_1984_2022.gpkg"</span>, package<span class="op">=</span><span class="st">"gdalraster"</span><span class="op">)</span></span>
<span><span class="co"># copy to a temporary in-memory file that is writeable</span></span>
<span><span class="va">dsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"/vsimem/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vsi_copy_file.html">vsi_copy_file</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">dsn</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lyr</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">GDALVector</span>, <span class="va">dsn</span>, <span class="st">"mtbs_perims"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># object of class GDALVector</span></span>
<span><span class="va">lyr</span></span>
<span><span class="co">#&gt; C++ object &lt;0x58a6a88edc80&gt; of class 'GDALVector' &lt;0x58a6a2fce150&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">lyr</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reference class 'Rcpp_GDALVector' [package "gdalraster"] with 0 fields</span></span>
<span><span class="co">#&gt;  list()</span></span>
<span><span class="co">#&gt;  and 44 methods, of which 30 are  possibly relevant:</span></span>
<span><span class="co">#&gt;    bbox, clearSpatialFilter, close, finalize, getDriverLongName,</span></span>
<span><span class="co">#&gt;    getDriverShortName, getDsn, getFeatureCount, getFIDColumn, getFileList,</span></span>
<span><span class="co">#&gt;    getGeometryColumn, getGeomType, getLayerDefn, getName, getNextFeature,</span></span>
<span><span class="co">#&gt;    getSpatialRef, initialize, isOpen, layerClip, layerErase, layerIdentity,</span></span>
<span><span class="co">#&gt;    layerIntersection, layerSymDifference, layerUnion, layerUpdate, open,</span></span>
<span><span class="co">#&gt;    resetReading, setAttributeFilter, setSpatialFilterRect, testCapability</span></span>
<span></span>
<span><span class="co"># dataset info</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getDriverShortName</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "GPKG"</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getDriverLongName</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "GeoPackage"</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getFileList</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "/vsimem/ynp_fires_1984_2022.gpkg"</span></span>
<span></span>
<span><span class="co"># layer info</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getName</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "mtbs_perims"</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getGeomType</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Multi Polygon"</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getGeometryColumn</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "geom"</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getFIDColumn</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "fid"</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getSpatialRef</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "PROJCS[\"NAD83 / Montana\",GEOGCS[\"NAD83\",DATUM[\"North_American_Datum_1983\",SPHEROID[\"GRS 1980\",6378137,298.257222101,AUTHORITY[\"EPSG\",\"7019\"]],AUTHORITY[\"EPSG\",\"6269\"]],PRIMEM[\"Greenwich\",0,AUTHORITY[\"EPSG\",\"8901\"]],UNIT[\"degree\",0.0174532925199433,AUTHORITY[\"EPSG\",\"9122\"]],AUTHORITY[\"EPSG\",\"4269\"]],PROJECTION[\"Lambert_Conformal_Conic_2SP\"],PARAMETER[\"latitude_of_origin\",44.25],PARAMETER[\"central_meridian\",-109.5],PARAMETER[\"standard_parallel_1\",49],PARAMETER[\"standard_parallel_2\",45],PARAMETER[\"false_easting\",600000],PARAMETER[\"false_northing\",0],UNIT[\"metre\",1,AUTHORITY[\"EPSG\",\"9001\"]],AXIS[\"Easting\",EAST],AXIS[\"Northing\",NORTH],AUTHORITY[\"EPSG\",\"32100\"]]"</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">bbox</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 469685.73 -12917.76 573531.72  96577.34</span></span>
<span></span>
<span><span class="co"># layer capabilities</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"RandomRead"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"FastSpatialFilter"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"FastFeatureCount"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"FastGetExtent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"Transactions"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># the dataset was opened read-only:</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"SequentialWrite"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"RandomWrite"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span></span>
<span><span class="co"># re-open with write access</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">open</span><span class="op">(</span>read_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"SequentialWrite"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"RandomWrite"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># feature class definition - a list of fields and their definitions</span></span>
<span><span class="va">defn</span> <span class="op">&lt;-</span> <span class="va">lyr</span><span class="op">$</span><span class="fu">getLayerDefn</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">defn</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "event_id"     "incid_name"   "incid_type"   "map_id"       "burn_bnd_ac"</span></span>
<span><span class="co">#&gt;  [6] "burn_bnd_lat" "burn_bnd_lon" "ig_date"      "ig_year"      "geom"</span></span>
<span></span>
<span><span class="co"># each list element holds a field definition list</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">defn</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 10</span></span>
<span><span class="co">#&gt;  $ event_id    :List of 8</span></span>
<span><span class="co">#&gt;   ..$ type       : chr "OFTString"</span></span>
<span><span class="co">#&gt;   ..$ width      : int 254</span></span>
<span><span class="co">#&gt;   ..$ precision  : int 0</span></span>
<span><span class="co">#&gt;   ..$ is_nullable: logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ is_unique  : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ default    : chr ""</span></span>
<span><span class="co">#&gt;   ..$ is_ignored : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ is_geom    : logi FALSE</span></span>
<span><span class="co">#&gt;  $ incid_name  :List of 8</span></span>
<span><span class="co">#&gt;   ..$ type       : chr "OFTString"</span></span>
<span><span class="co">#&gt;   ..$ width      : int 254</span></span>
<span><span class="co">#&gt;   ..$ precision  : int 0</span></span>
<span><span class="co">#&gt;   ..$ is_nullable: logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ is_unique  : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ default    : chr ""</span></span>
<span><span class="co">#&gt;   ..$ is_ignored : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ is_geom    : logi FALSE</span></span>
<span><span class="co">#&gt;  $ incid_type  :List of 8</span></span>
<span><span class="co">#&gt;   ..$ type       : chr "OFTString"</span></span>
<span><span class="co">#&gt;   ..$ width      : int 254</span></span>
<span><span class="co">#&gt;   ..$ precision  : int 0</span></span>
<span><span class="co">#&gt;   ..$ is_nullable: logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ is_unique  : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ default    : chr ""</span></span>
<span><span class="co">#&gt;   ..$ is_ignored : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ is_geom    : logi FALSE</span></span>
<span><span class="co">#&gt;  $ map_id      :List of 8</span></span>
<span><span class="co">#&gt;   ..$ type       : chr "OFTInteger64"</span></span>
<span><span class="co">#&gt;   ..$ width      : int 0</span></span>
<span><span class="co">#&gt;   ..$ precision  : int 0</span></span>
<span><span class="co">#&gt;   ..$ is_nullable: logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ is_unique  : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ default    : chr ""</span></span>
<span><span class="co">#&gt;   ..$ is_ignored : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ is_geom    : logi FALSE</span></span>
<span><span class="co">#&gt;  $ burn_bnd_ac :List of 8</span></span>
<span><span class="co">#&gt;   ..$ type       : chr "OFTInteger64"</span></span>
<span><span class="co">#&gt;   ..$ width      : int 0</span></span>
<span><span class="co">#&gt;   ..$ precision  : int 0</span></span>
<span><span class="co">#&gt;   ..$ is_nullable: logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ is_unique  : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ default    : chr ""</span></span>
<span><span class="co">#&gt;   ..$ is_ignored : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ is_geom    : logi FALSE</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lat:List of 8</span></span>
<span><span class="co">#&gt;   ..$ type       : chr "OFTString"</span></span>
<span><span class="co">#&gt;   ..$ width      : int 10</span></span>
<span><span class="co">#&gt;   ..$ precision  : int 0</span></span>
<span><span class="co">#&gt;   ..$ is_nullable: logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ is_unique  : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ default    : chr ""</span></span>
<span><span class="co">#&gt;   ..$ is_ignored : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ is_geom    : logi FALSE</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lon:List of 8</span></span>
<span><span class="co">#&gt;   ..$ type       : chr "OFTString"</span></span>
<span><span class="co">#&gt;   ..$ width      : int 10</span></span>
<span><span class="co">#&gt;   ..$ precision  : int 0</span></span>
<span><span class="co">#&gt;   ..$ is_nullable: logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ is_unique  : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ default    : chr ""</span></span>
<span><span class="co">#&gt;   ..$ is_ignored : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ is_geom    : logi FALSE</span></span>
<span><span class="co">#&gt;  $ ig_date     :List of 8</span></span>
<span><span class="co">#&gt;   ..$ type       : chr "default (read as OFTString)"</span></span>
<span><span class="co">#&gt;   ..$ width      : int 0</span></span>
<span><span class="co">#&gt;   ..$ precision  : int 0</span></span>
<span><span class="co">#&gt;   ..$ is_nullable: logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ is_unique  : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ default    : chr ""</span></span>
<span><span class="co">#&gt;   ..$ is_ignored : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ is_geom    : logi FALSE</span></span>
<span><span class="co">#&gt;  $ ig_year     :List of 8</span></span>
<span><span class="co">#&gt;   ..$ type       : chr "OFTInteger"</span></span>
<span><span class="co">#&gt;   ..$ width      : int 0</span></span>
<span><span class="co">#&gt;   ..$ precision  : int 0</span></span>
<span><span class="co">#&gt;   ..$ is_nullable: logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ is_unique  : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ default    : chr ""</span></span>
<span><span class="co">#&gt;   ..$ is_ignored : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ is_geom    : logi FALSE</span></span>
<span><span class="co">#&gt;  $ geom        :List of 5</span></span>
<span><span class="co">#&gt;   ..$ type       : chr "Multi Polygon"</span></span>
<span><span class="co">#&gt;   ..$ srs        : chr "PROJCS[\"NAD83 / Montana\",GEOGCS[\"NAD83\",DATUM[\"North_American_Datum_1983\",SPHEROID[\"GRS 1980\",6378137,2"| __truncated__</span></span>
<span><span class="co">#&gt;   ..$ is_nullable: logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ is_ignored : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ is_geom    : logi TRUE</span></span>
<span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 61</span></span>
<span></span>
<span><span class="co"># cursor</span></span>
<span><span class="va">feat</span> <span class="op">&lt;-</span> <span class="va">lyr</span><span class="op">$</span><span class="fu">getNextFeature</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># a list of field names and their values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">feat</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 11</span></span>
<span><span class="co">#&gt;  $ FID         :integer64 1</span></span>
<span><span class="co">#&gt;  $ event_id    : chr "WY4413411069519870807"</span></span>
<span><span class="co">#&gt;  $ incid_name  : chr "POLECAT"</span></span>
<span><span class="co">#&gt;  $ incid_type  : chr "Wildfire"</span></span>
<span><span class="co">#&gt;  $ map_id      :integer64 10015934</span></span>
<span><span class="co">#&gt;  $ burn_bnd_ac :integer64 1093</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lat: chr "44.132"</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lon: chr "-110.696"</span></span>
<span><span class="co">#&gt;  $ ig_date     : chr "1987/08/07"</span></span>
<span><span class="co">#&gt;  $ ig_year     : int 1987</span></span>
<span><span class="co">#&gt;  $ geom        : chr "MULTIPOLYGON (((503099.439579653 -12893.9672899192,503169.756694236 -12756.3721247327,502689.845907435 -12131.5"| __truncated__</span></span>
<span></span>
<span><span class="co"># attribute filter</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">setAttributeFilter</span><span class="op">(</span><span class="st">"ig_year = 2020"</span><span class="op">)</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="va">feat</span> <span class="op">&lt;-</span> <span class="va">lyr</span><span class="op">$</span><span class="fu">getNextFeature</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">feat</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 11</span></span>
<span><span class="co">#&gt;  $ FID         :integer64 61</span></span>
<span><span class="co">#&gt;  $ event_id    : chr "WY4438911082120200822"</span></span>
<span><span class="co">#&gt;  $ incid_name  : chr "LONE STAR"</span></span>
<span><span class="co">#&gt;  $ incid_type  : chr "Wildfire"</span></span>
<span><span class="co">#&gt;  $ map_id      :integer64 10020495</span></span>
<span><span class="co">#&gt;  $ burn_bnd_ac :integer64 3348</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lat: chr "44.4"</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lon: chr "-110.782"</span></span>
<span><span class="co">#&gt;  $ ig_date     : chr "2020/08/22"</span></span>
<span><span class="co">#&gt;  $ ig_year     : int 2020</span></span>
<span><span class="co">#&gt;  $ geom        : chr "MULTIPOLYGON (((496593.122306971 15506.8828590633,496491.761299067 15605.3612548792,496290.812130161 15388.0465"| __truncated__</span></span>
<span></span>
<span><span class="co"># NULL if no more features are available</span></span>
<span><span class="va">feat</span> <span class="op">&lt;-</span> <span class="va">lyr</span><span class="op">$</span><span class="fu">getNextFeature</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">feat</span><span class="op">)</span></span>
<span><span class="co">#&gt;  NULL</span></span>
<span></span>
<span><span class="co"># reset reading to the start</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">resetReading</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">feat</span> <span class="op">&lt;-</span> <span class="va">lyr</span><span class="op">$</span><span class="fu">getNextFeature</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">feat</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 11</span></span>
<span><span class="co">#&gt;  $ FID         :integer64 61</span></span>
<span><span class="co">#&gt;  $ event_id    : chr "WY4438911082120200822"</span></span>
<span><span class="co">#&gt;  $ incid_name  : chr "LONE STAR"</span></span>
<span><span class="co">#&gt;  $ incid_type  : chr "Wildfire"</span></span>
<span><span class="co">#&gt;  $ map_id      :integer64 10020495</span></span>
<span><span class="co">#&gt;  $ burn_bnd_ac :integer64 3348</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lat: chr "44.4"</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lon: chr "-110.782"</span></span>
<span><span class="co">#&gt;  $ ig_date     : chr "2020/08/22"</span></span>
<span><span class="co">#&gt;  $ ig_year     : int 2020</span></span>
<span><span class="co">#&gt;  $ geom        : chr "MULTIPOLYGON (((496593.122306971 15506.8828590633,496491.761299067 15605.3612548792,496290.812130161 15388.0465"| __truncated__</span></span>
<span></span>
<span><span class="co"># clear attribute filter</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">setAttributeFilter</span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 61</span></span>
<span></span>
<span><span class="co"># spatial filter</span></span>
<span><span class="co"># get the bounding box of the largest 1988 fire</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">setAttributeFilter</span><span class="op">(</span><span class="st">"ig_year = 1988 ORDER BY burn_bnd_ac DESC"</span><span class="op">)</span></span>
<span><span class="va">feat</span> <span class="op">&lt;-</span> <span class="va">lyr</span><span class="op">$</span><span class="fu">getNextFeature</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">feat</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 11</span></span>
<span><span class="co">#&gt;  $ FID         :integer64 7</span></span>
<span><span class="co">#&gt;  $ event_id    : chr "WY4470811082119880722"</span></span>
<span><span class="co">#&gt;  $ incid_name  : chr "NORTH FORK"</span></span>
<span><span class="co">#&gt;  $ incid_type  : chr "Wildfire"</span></span>
<span><span class="co">#&gt;  $ map_id      :integer64 10014217</span></span>
<span><span class="co">#&gt;  $ burn_bnd_ac :integer64 563527</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lat: chr "44.678"</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lon: chr "-110.716"</span></span>
<span><span class="co">#&gt;  $ ig_date     : chr "1988/07/22"</span></span>
<span><span class="co">#&gt;  $ ig_year     : int 1988</span></span>
<span><span class="co">#&gt;  $ geom        : chr "MULTIPOLYGON (((469685.969312071 29526.2354109807,469918.933844832 29654.3220754602,470030.299119989 29518.7441"| __truncated__</span></span>
<span></span>
<span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bbox_from_wkt.html">bbox_from_wkt</a></span><span class="op">(</span><span class="va">feat</span><span class="op">$</span><span class="va">geom</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bbox</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 469685.97  11442.45 544069.63  85508.15</span></span>
<span></span>
<span><span class="co"># clear the attribute filter</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">setAttributeFilter</span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 61</span></span>
<span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">setSpatialFilterRect</span><span class="op">(</span><span class="va">bbox</span><span class="op">)</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 40</span></span>
<span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">clearSpatialFilter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 61</span></span>
<span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vsi_unlink.html">vsi_unlink</a></span><span class="op">(</span><span class="va">dsn</span><span class="op">)</span></span></code></pre></div>
<p><sup>Created on 2024-04-06 with <a href="https://reprex.tidyverse.org" class="external-link">reprex v2.1.0</a></sup></p>
</div>
<div class="section level2">
<h2 id="example-layer-geoprocessing">Example: layer geoprocessing<a class="anchor" aria-label="anchor" href="#example-layer-geoprocessing"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## layer intersection example</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usdaforestservice.github.io/gdalraster/">gdalraster</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; GDAL 3.8.4, released 2024/02/08, GEOS 3.12.1, PROJ 9.3.1</span></span>
<span></span>
<span><span class="co"># MTBS fires in Yellowstone National Park 1984-2022</span></span>
<span><span class="va">dsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/ynp_fires_1984_2022.gpkg"</span>, package<span class="op">=</span><span class="st">"gdalraster"</span><span class="op">)</span></span>
<span><span class="va">lyr</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">GDALVector</span>, <span class="va">dsn</span>, <span class="st">"mtbs_perims"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># largest 1988 fire (FID = 7 from the example above)</span></span>
<span><span class="va">feat</span> <span class="op">&lt;-</span> <span class="va">lyr</span><span class="op">$</span><span class="fu">getFeature</span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">feat</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 11</span></span>
<span><span class="co">#&gt;  $ FID         :integer64 7</span></span>
<span><span class="co">#&gt;  $ event_id    : chr "WY4470811082119880722"</span></span>
<span><span class="co">#&gt;  $ incid_name  : chr "NORTH FORK"</span></span>
<span><span class="co">#&gt;  $ incid_type  : chr "Wildfire"</span></span>
<span><span class="co">#&gt;  $ map_id      :integer64 10014217</span></span>
<span><span class="co">#&gt;  $ burn_bnd_ac :integer64 563527</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lat: chr "44.678"</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lon: chr "-110.716"</span></span>
<span><span class="co">#&gt;  $ ig_date     : chr "1988/07/22"</span></span>
<span><span class="co">#&gt;  $ ig_year     : int 1988</span></span>
<span><span class="co">#&gt;  $ geom        : chr "MULTIPOLYGON (((469685.969312071 29526.2354109807,469918.933844832 29654.3220754602,470030.299119989 29518.7441"| __truncated__</span></span>
<span></span>
<span><span class="co"># get a second layer for 2000-2022 fires</span></span>
<span><span class="co"># the layer argument can be a sql statement</span></span>
<span><span class="va">sql</span> <span class="op">&lt;-</span> <span class="st">"SELECT FID, * FROM mtbs_perims WHERE ig_year &gt;= 2000 ORDER BY mtbs_perims.ig_year"</span></span>
<span><span class="va">lyr2</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">GDALVector</span>, <span class="va">dsn</span>, <span class="va">sql</span><span class="op">)</span></span>
<span><span class="va">lyr2</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 40</span></span>
<span></span>
<span><span class="co"># create an output layer using a temporary in-memory dataset</span></span>
<span><span class="va">dsn_out</span> <span class="op">&lt;-</span> <span class="st">"/vsimem/lyr_proc_tmp.gpkg"</span></span>
<span><span class="va">srs</span> <span class="op">&lt;-</span> <span class="va">lyr</span><span class="op">$</span><span class="fu">getSpatialRef</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># this uses existing internal OGR utilities</span></span>
<span><span class="fu">gdalraster</span><span class="fu">:::</span><span class="fu">.create_ogr</span><span class="op">(</span><span class="st">"GPKG"</span>, <span class="va">dsn_out</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="st">"Unknown"</span>, <span class="st">"result_layer"</span>, <span class="va">srs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu">gdalraster</span><span class="fu">:::</span><span class="fu">.ogr_ds_exists</span><span class="op">(</span><span class="va">dsn_out</span>, with_update <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu">gdalraster</span><span class="fu">:::</span><span class="fu">.ogr_layer_exists</span><span class="op">(</span><span class="va">dsn_out</span>, <span class="st">"result_layer"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">lyr_out</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">GDALVector</span>, <span class="va">dsn_out</span>, <span class="st">"result_layer"</span>, read_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">lyr_out</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="co"># intersection of lyr and lyr2, with result in lyr_out</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">layerIntersection</span><span class="op">(</span><span class="va">lyr2</span>, <span class="va">lyr_out</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span>, options <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0...10...20...30...40...50...60...70...80...90...100 - done.</span></span>
<span></span>
<span><span class="va">lyr_out</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="va">defn</span> <span class="op">&lt;-</span> <span class="va">lyr_out</span><span class="op">$</span><span class="fu">getLayerDefn</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># combined attributes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">defn</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "input_event_id"      "input_incid_name"    "input_incid_type"</span></span>
<span><span class="co">#&gt;  [4] "input_map_id"        "input_burn_bnd_ac"   "input_burn_bnd_lat"</span></span>
<span><span class="co">#&gt;  [7] "input_burn_bnd_lon"  "input_ig_date"       "input_ig_year"</span></span>
<span><span class="co">#&gt; [10] "method_event_id"     "method_incid_name"   "method_incid_type"</span></span>
<span><span class="co">#&gt; [13] "method_map_id"       "method_burn_bnd_ac"  "method_burn_bnd_lat"</span></span>
<span><span class="co">#&gt; [16] "method_burn_bnd_lon" "method_ig_date"      "method_ig_year"</span></span>
<span><span class="co">#&gt; [19] "geom"</span></span>
<span></span>
<span><span class="co"># we don't have vector plotting yet, so rasterize and use plot_raster()</span></span>
<span><span class="va">out_file</span> <span class="op">&lt;-</span> <span class="st">"/vsimem/result_layer.tif"</span></span>
<span><span class="fu"><a href="../reference/rasterize.html">rasterize</a></span><span class="op">(</span>src_dsn <span class="op">=</span> <span class="va">dsn_out</span>,</span>
<span>          dstfile <span class="op">=</span> <span class="va">out_file</span>,</span>
<span>          layer <span class="op">=</span> <span class="st">"result_layer"</span>,</span>
<span>          burn_attr <span class="op">=</span> <span class="st">"method_ig_year"</span>,</span>
<span>          tr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>,<span class="fl">90</span><span class="op">)</span>,</span>
<span>          tap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          dtName <span class="op">=</span> <span class="st">"Int16"</span>,</span>
<span>          dstnodata <span class="op">=</span> <span class="op">-</span><span class="fl">9999</span>,</span>
<span>          init <span class="op">=</span> <span class="op">-</span><span class="fl">9999</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0...10...20...30...40...50...60...70...80...90...100 - done.</span></span>
<span></span>
<span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">GDALRaster</span>, <span class="va">out_file</span><span class="op">)</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_viridis.html" class="external-link">viridis_pal</a></span><span class="op">(</span>end <span class="op">=</span> <span class="fl">0.8</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">ramp</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/colour_ramp.html" class="external-link">colour_ramp</a></span><span class="op">(</span><span class="va">pal</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_raster.html">plot_raster</a></span><span class="op">(</span><span class="va">ds</span>, legend <span class="op">=</span> <span class="cn">TRUE</span>, col_map_fn <span class="op">=</span> <span class="va">ramp</span>, na_col <span class="op">=</span> <span class="st">"#d9d9d9"</span>,</span>
<span>            main<span class="op">=</span><span class="st">"2000-2022 re-burn within the 1988 North Fork perimeter"</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/ynp_mtbs_lyr_int_ex.png"><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ds</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lyr</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lyr2</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lyr_out</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/vsi_unlink.html">vsi_unlink</a></span><span class="op">(</span><span class="va">dsn_out</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vsi_unlink.html">vsi_unlink</a></span><span class="op">(</span><span class="va">out_file</span><span class="op">)</span></span></code></pre></div>
<p><sup>Created on 2024-04-06 with <a href="https://reprex.tidyverse.org" class="external-link">reprex v2.1.0</a></sup></p>
</div>
<div class="section level2">
<h2 id="example-worldcover-sentinel-2-composites">Example: WorldCover Sentinel-2 composites<a class="anchor" aria-label="anchor" href="#example-worldcover-sentinel-2-composites"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## WorldCover Sentinel-2 annual composites</span></span>
<span><span class="co">## https://blog.vito.be/remotesensing/worldcover-annual-composites</span></span>
<span><span class="co">## tile index lookup on remote filesystem and obtain raster data</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usdaforestservice.github.io/gdalraster/">gdalraster</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; GDAL 3.8.4, released 2024/02/08, GEOS 3.12.1, PROJ 9.3.1</span></span>
<span></span>
<span><span class="va">fgb</span> <span class="op">=</span> <span class="st">"/vsicurl/https://esa-worldcover.s3.eu-central-1.amazonaws.com/esa_worldcover_grid_composites.fgb"</span></span>
<span><span class="va">lyr_tiles</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">GDALVector</span>, <span class="va">fgb</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">getDriverShortName</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "FlatGeobuf"</span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">getName</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "worldcover_composites_grid_aws"</span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">getGeomType</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Polygon"</span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">getSpatialRef</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0,AUTHORITY[\"EPSG\",\"8901\"]],UNIT[\"degree\",0.0174532925199433,AUTHORITY[\"EPSG\",\"9122\"]],AXIS[\"Latitude\",NORTH],AXIS[\"Longitude\",EAST],AUTHORITY[\"EPSG\",\"4326\"]]"</span></span>
<span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"RandomRead"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"FastSpatialFilter"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"FastFeatureCount"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">testCapability</span><span class="op">(</span><span class="st">"FastGetExtent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 19363</span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">bbox</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -180  -60  180   83</span></span>
<span></span>
<span><span class="va">defn</span> <span class="op">&lt;-</span> <span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">getLayerDefn</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">defn</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "tile"              "s1_vvvhratio_2020" "s1_vvvhratio_2021"</span></span>
<span><span class="co">#&gt;  [4] "s2_rgbnir_2020"    "s2_rgbnir_2021"    "s2_ndvi_2020"</span></span>
<span><span class="co">#&gt;  [7] "s2_ndvi_2021"      "s2_swir_2020"      "s2_swir_2021"</span></span>
<span><span class="co">#&gt; [10] ""</span></span>
<span></span>
<span><span class="co"># AOI for the Fishhawk fire</span></span>
<span><span class="va">dsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/ynp_fires_1984_2022.gpkg"</span>, package<span class="op">=</span><span class="st">"gdalraster"</span><span class="op">)</span></span>
<span><span class="va">lyr_ynp</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">GDALVector</span>, <span class="va">dsn</span>, <span class="st">"mtbs_perims"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lyr_ynp</span><span class="op">$</span><span class="fu">setAttributeFilter</span><span class="op">(</span><span class="st">"incid_name = 'FISHHAWK'"</span><span class="op">)</span></span>
<span><span class="va">lyr_ynp</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="va">feat</span> <span class="op">&lt;-</span> <span class="va">lyr_ynp</span><span class="op">$</span><span class="fu">getNextFeature</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">feat</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 11</span></span>
<span><span class="co">#&gt;  $ FID         :integer64 60</span></span>
<span><span class="co">#&gt;  $ event_id    : chr "WY4437710988020190902"</span></span>
<span><span class="co">#&gt;  $ incid_name  : chr "FISHHAWK"</span></span>
<span><span class="co">#&gt;  $ incid_type  : chr "Wildfire"</span></span>
<span><span class="co">#&gt;  $ map_id      :integer64 10016957</span></span>
<span><span class="co">#&gt;  $ burn_bnd_ac :integer64 10775</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lat: chr "44.384"</span></span>
<span><span class="co">#&gt;  $ burn_bnd_lon: chr "-109.85"</span></span>
<span><span class="co">#&gt;  $ ig_date     : chr "2019/09/02"</span></span>
<span><span class="co">#&gt;  $ ig_year     : int 2019</span></span>
<span><span class="co">#&gt;  $ geom        : chr "MULTIPOLYGON (((573530.585472236 9160.22088906913,573266.183153384 9415.42216938034,573137.427110327 9285.44517"| __truncated__</span></span>
<span></span>
<span><span class="co"># get the feature bbox in WGS84</span></span>
<span><span class="va">bb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/g_transform.html">g_transform</a></span><span class="op">(</span><span class="va">feat</span><span class="op">$</span><span class="va">geom</span>, <span class="va">lyr_ynp</span><span class="op">$</span><span class="fu">getSpatialRef</span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/epsg_to_wkt.html">epsg_to_wkt</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bbox_from_wkt.html">bbox_from_wkt</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bb</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -109.89753   44.32714 -109.83172   44.44030</span></span>
<span></span>
<span><span class="co"># tile index lookup</span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">setSpatialFilterRect</span><span class="op">(</span><span class="va">bb</span><span class="op">)</span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">getFeatureCount</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="va">feat</span> <span class="op">&lt;-</span> <span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">getNextFeature</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">feat</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 11</span></span>
<span><span class="co">#&gt;  $ FID              :integer64 16615</span></span>
<span><span class="co">#&gt;  $ tile             : chr "N44W110"</span></span>
<span><span class="co">#&gt;  $ s1_vvvhratio_2020: chr "s3://esa-worldcover-s1/vvvhratio/2020/N44/ESA_WorldCover_10m_2020_v100_N44W110_S1VVVHratio.tif"</span></span>
<span><span class="co">#&gt;  $ s1_vvvhratio_2021: chr "s3://esa-worldcover-s1/vvvhratio/2021/N44/ESA_WorldCover_10m_2021_v200_N44W110_S1VVVHratio.tif"</span></span>
<span><span class="co">#&gt;  $ s2_rgbnir_2020   : chr "s3://esa-worldcover-s2/rgbnir/2020/N44/ESA_WorldCover_10m_2020_v100_N44W110_S2RGBNIR.tif"</span></span>
<span><span class="co">#&gt;  $ s2_rgbnir_2021   : chr "s3://esa-worldcover-s2/rgbnir/2021/N44/ESA_WorldCover_10m_2021_v200_N44W110_S2RGBNIR.tif"</span></span>
<span><span class="co">#&gt;  $ s2_ndvi_2020     : chr "s3://esa-worldcover-s2/ndvi/2020/N44/ESA_WorldCover_10m_2020_v100_N44W110_NDVI.tif"</span></span>
<span><span class="co">#&gt;  $ s2_ndvi_2021     : chr "s3://esa-worldcover-s2/ndvi/2021/N44/ESA_WorldCover_10m_2021_v200_N44W110_NDVI.tif"</span></span>
<span><span class="co">#&gt;  $ s2_swir_2020     : chr "s3://esa-worldcover-s2/swir/2020/N44/ESA_WorldCover_10m_2020_v100_N44W110_SWIR.tif"</span></span>
<span><span class="co">#&gt;  $ s2_swir_2021     : chr "s3://esa-worldcover-s2/swir/2021/N44/ESA_WorldCover_10m_2021_v200_N44W110_SWIR.tif"</span></span>
<span><span class="co">#&gt;  $                  : chr "POLYGON ((-110 44,-110 45,-109 45,-109 44,-110 44))"</span></span>
<span></span>
<span><span class="co"># get the Sentinel-2 RGBNIR composite for this AOI</span></span>
<span><span class="va">tif_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"s3://"</span>, <span class="st">"/vsis3/"</span>, <span class="va">feat</span><span class="op">$</span><span class="va">s2_rgbnir_2021</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tif_file</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "/vsis3/esa-worldcover-s2/rgbnir/2021/N44/ESA_WorldCover_10m_2021_v200_N44W110_S2RGBNIR.tif"</span></span>
<span></span>
<span><span class="co"># public bucket so disable request signing</span></span>
<span><span class="fu"><a href="../reference/set_config_option.html">set_config_option</a></span><span class="op">(</span><span class="st">"AWS_NO_SIGN_REQUEST"</span>, <span class="st">"YES"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check if file exists and get size in MB</span></span>
<span><span class="fu"><a href="../reference/vsi_stat.html">vsi_stat</a></span><span class="op">(</span><span class="va">tif_file</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/vsi_stat.html">vsi_stat</a></span><span class="op">(</span><span class="va">tif_file</span>, <span class="st">"size"</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1000</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 562.039</span></span>
<span></span>
<span><span class="co"># copy to a local or remote filesystem, e.g.,</span></span>
<span><span class="co"># tif_copy &lt;- file.path(tempdir(), basename(tif_file))</span></span>
<span><span class="co"># vsi_copy_file(tif_file, tif_copy, show_progress = TRUE)</span></span>
<span></span>
<span><span class="co"># or open the dataset for reading</span></span>
<span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">GDALRaster</span>, <span class="va">tif_file</span><span class="op">)</span></span>
<span><span class="va">ds</span><span class="op">$</span><span class="fu">dim</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12000 12000     4</span></span>
<span><span class="va">ds</span><span class="op">$</span><span class="fu">getMetadata</span><span class="op">(</span>band<span class="op">=</span><span class="fl">0</span>, domain<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "algorithm_version=V2.0.0"</span></span>
<span><span class="co">#&gt;  [2] "AREA_OR_POINT=Area"</span></span>
<span><span class="co">#&gt;  [3] "bands=Band 1: B04 (Red), Band 2: B03 (Green), Band 3: B02 (Blue), Band 4: B08 (Infrared)"</span></span>
<span><span class="co">#&gt;  [4] "copyright=ESA WorldCover project 2021 / Contains modified Copernicus Sentinel data (2021) processed by ESA WorldCover consortium"</span></span>
<span><span class="co">#&gt;  [5] "creation_time=2022-12-09 17:08:25.881589"</span></span>
<span><span class="co">#&gt;  [6] "description=The ESA WorldCover Sentinel-2 median L2A (RGBNIR) composite is a color image made from images in Blue (B02), Green (B03), Red (B04) and Infrared (B08). "</span></span>
<span><span class="co">#&gt;  [7] "license=CC-BY 4.0 - https://creativecommons.org/licenses/by/4.0/"</span></span>
<span><span class="co">#&gt;  [8] "product_crs=EPSG:4326"</span></span>
<span><span class="co">#&gt;  [9] "product_grid=1x1 degree tiling grid"</span></span>
<span><span class="co">#&gt; [10] "product_tile=N44W110"</span></span>
<span><span class="co">#&gt; [11] "product_type=Sentinel-2 median L2A (RGBNIR) composite"</span></span>
<span><span class="co">#&gt; [12] "product_version=V2.0.0"</span></span>
<span><span class="co">#&gt; [13] "reference=https://esa-worldcover.org"</span></span>
<span><span class="co">#&gt; [14] "time_end=2021-12-31T23:59:59Z"</span></span>
<span><span class="co">#&gt; [15] "time_start=2021-01-01T00:00:00Z"</span></span>
<span><span class="co">#&gt; [16] "title=ESA WorldCover Sentinel-2 median L2A (RGBNIR) composite at 10m resolution for year 2021"</span></span>
<span><span class="va">ds</span><span class="op">$</span><span class="fu">getMetadata</span><span class="op">(</span>band<span class="op">=</span><span class="fl">0</span>, domain<span class="op">=</span><span class="st">"IMAGE_STRUCTURE"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "COMPRESSION=DEFLATE" "INTERLEAVE=PIXEL"    "LAYOUT=COG"</span></span>
<span><span class="co">#&gt; [4] "PREDICTOR=2"</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ds.html">read_ds</a></span><span class="op">(</span><span class="va">ds</span>, bands<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, out_xsize <span class="op">=</span> <span class="fl">800</span>, out_ysize <span class="op">=</span> <span class="fl">800</span><span class="op">)</span></span>
<span><span class="va">txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/fileutils.html" class="external-link">file_path_sans_ext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">tif_file</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              <span class="st">"\n(color infrared B8-B4-B3)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_raster.html">plot_raster</a></span><span class="op">(</span><span class="va">r</span>,</span>
<span>            minmax_pct_cut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">98</span><span class="op">)</span>,</span>
<span>            xlab <span class="op">=</span> <span class="st">"longitude"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"latitude"</span>,</span>
<span>            main <span class="op">=</span> <span class="va">txt</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/worldcov2021_N44W110_S2RGBNIR_ex.png"><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ds</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lyr_ynp</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lyr_tiles</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><sup>Created on 2024-04-06 with <a href="https://reprex.tidyverse.org" class="external-link">reprex v2.1.0</a></sup></p>
</div>
<div class="section level2">
<h2 id="further-consideration-tbd">Further consideration / TBD<a class="anchor" aria-label="anchor" href="#further-consideration-tbd"></a>
</h2>
<p>This is a working list of potential issues and design questions that
need further consideration, to be determined:</p>
<ul>
<li>handling of 64-bit integer: OGR FID currently is
<code>GIntBig</code> and integer fields in vector data sources will
commonly be <code>OFTInteger64</code>. These are now handled using
<strong>RcppInt64</strong>, with <strong>bit64</strong> on the R side
providing S3 class <code>integer64</code>.</li>
<li>OGR’s Arrow C interface: Implement
<code>GDALVector::getArrowStream()</code> (GDAL &gt;= 3.6) and
<code>GDALVector::writeArrowBatch()</code> (GDAL &gt;= 3.8), supported
on the R side with package <strong>nanoarrow</strong>.</li>
<li>potential output vectors of GEOS or OGR pointers, WKB with support
by <strong>wk</strong>
</li>
<li>OGR layer geoprocessing might be stand-alone functions instead of
class methods in <code>GDALVector</code>. We would have more flexibility
in terms of optional/argument defaults. Either way, we should add an
option to create the output layer.</li>
</ul>
</div>
<div class="section level2">
<h2 id="document-changelog">Document changelog<a class="anchor" aria-label="anchor" href="#document-changelog"></a>
</h2>
<ul>
<li>add <code>GDALVector::setSpatialFilter()</code> to the draft class
definition - set spatial filter from WKT geometry (2024-03-02)</li>
<li>add comment in the layer intersection example re: feature retrieval
by FID (2024-03-02)</li>
<li>add arguments <code>fields</code> and <code>geom_column</code> in
<code>GDALVector::getFeatureSet()</code> - optionally retrieve a subset
of attribute fields, and specify whether to include geometry column(s)
in the returned data frame (2024-03-02)</li>
<li>the return value of feature writing methods should be the FID of the
newly created/set/deleted feature upon successful write, or
<code>OGRNullFID</code> on failure (2024-03-02)</li>
<li>add a note above <code>class GDALVector</code> re: handling of
64-bit integer types to be determined (2024-03-02)</li>
<li>add <code>GDALVector::setIgnoredFields()</code>: set which fields
can be omitted when retrieving features from the layer. If the driver
supports this functionality (testable using OLCIgnoreFields capability),
it will not fetch the specified fields in subsequent calls to
<code>getFeature()</code> / <code>getNextFeature()</code> thus save some
processing time and/or bandwidth. (2024-03-02)</li>
<li>add <code>ogr_execute_sql()</code> for dataset/schema management
(2024-03-02)</li>
<li>add <code>GDALVector::setNextByIndex()</code> for cursor positioning
(2024-03-03)</li>
<li>add <code>GDALVector::getSpatialFilter()</code>: get the WKT
geometry currently in use as the spatial filter, or <code>""</code>
(2024-03-03)</li>
<li>add section “Further consideration / TBD” (2024-03-03)</li>
<li>
<code><a href="../reference/ogr2ogr.html">ogr2ogr()</a></code> and <code><a href="../reference/ogrinfo.html">ogrinfo()</a></code> are available in
1.9.0.9080 dev (2024-03-04)</li>
<li>add potential output vectors of geos or ogr pointers, or wkb/wkt
with support by {wk} (<span class="citation">@mdsumner</span>,
2024-03-04)</li>
<li>add section “Contributors” (2024-03-04)</li>
<li>add link to issue 241 for discussion thread (2024-03-05)</li>
<li>OGR layer geoprocessing may be stand-alone functions instead of
class methods TBD (2024-03-10)</li>
<li>add link to the header file to reference the class methods that have
been implemented so far in the prototype (2024-03-10)</li>
<li>
<code><a href="../reference/ogr2ogr.html">ogr2ogr()</a></code> and <code><a href="../reference/ogrinfo.html">ogrinfo()</a></code> are available in
<strong>gdalraster</strong> 1.10.0 on CRAN (2024-03-26)</li>
<li>initial int64 support; now linking to <strong>RcppInt64</strong>,
and importing <strong>bit64</strong>; <code>FID</code> and
<code>OFTInteger64</code> fields are now returned in R as
<code>integer64</code>; updated the examples (2024-04-06)</li>
<li>add <code>GDALVector::getFeature()</code>: fetch a feature from its
FID (2024-04-06)</li>
<li>add a <code>GDALVector</code> class constructor with
<code>spatial_filter</code> and SQL <code>dialect</code> arguments
(2024-04-28)</li>
</ul>
</div>
<div class="section level2">
<h2 id="contributors">Contributors<a class="anchor" aria-label="anchor" href="#contributors"></a>
</h2>
<ul>
<li>
<a href="https://github.com/goergen95" class="external-link"><span class="citation">@goergen95</span></a> (<a href="https://github.com/USDAForestService/gdalraster/issues/205" class="external-link">#205</a>)</li>
<li><a href="https://github.com/mdsumner" class="external-link"><span class="citation">@mdsumner</span></a></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/ctoney" class="external-link">Chris Toney</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
